var notation={data:{}};function ajaxCallRemoteNotationAction(c,f){var a=document.getElementById("questionNotation").value.replace(/\n/g,"\r\n");if(document.getElementById("questionnaire_notation_presision").style.display!="none"&&a==""){a="okTexteInsati"}var d="/PortailAS/mesureSatisfaction.do?method="+c+"&idNoCache="+new Date().getTime()+"&etatInsatisfaction="+encodeURIComponent(a);var b=document.getElementById("emplacementQuestionnaireNotation").value;var e=document.getElementById("typeQuestionnaireNotation");var g="";if(e!=null){g=document.getElementById("typeQuestionnaireNotation").value}document.getElementById("closeQuestionnaireNotation").innerHTML="X";if(window.XMLHttpRequest){reqNotation=new XMLHttpRequest();reqNotation.onreadystatechange=function(){traiterRetourEB()};reqNotation.open("GET",d,true);testEtAffecteAttributsRequeteNotation(reqNotation,f,b,g);reqNotation.send()}else{if(window.ActiveXObject){reqNotation=new ActiveXObject("Microsoft.XMLHTTP");reqNotation.onreadystatechange=function(){traiterRetourEB()};reqNotation.open("GET",d,true);testEtAffecteAttributsRequeteNotation(reqNotation,f,b,g);reqNotation.send()}else{return}}}function traiterRetourEB(){if(reqNotation.readyState==4){if(reqNotation.status==200){if(reqNotation.responseText.contains("initialiserNotation")){initialiserQuestionnaireNotation(reqNotation.responseText)}else{if(reqNotation.responseText.contains("envoyerNotation;")){afficherMerciNotation()}else{if(reqNotation.responseText.contains("envoyerNotationErreur;")){afficherMerciNotationErreur()}else{if(reqNotation.responseText==""){viderQuestionnaireNotation()}}}}}}}function testEtAffecteAttributsRequeteNotation(b,d,a,c){if(b==null){return}if(d!=null){b.setRequestHeader("etatSatisfaction",d)}if(a!=null){b.setRequestHeader("emplacementQuestionnaireNotation",a)}if(c!=null){b.setRequestHeader("typeQuestionnaireNotation",c)}}function remercierNotation(){document.getElementById("btnQuestNotation_Valider").disabled=true;var a=notationAssure();ajaxCallRemoteNotationAction("envoyerNotation",a)}function afficherMerciNotation(){var b=document.getElementById("timeOutQuestionnaireNotation").value;var a=parseFloat(b)+parseFloat(1000);document.getElementById("popupNotationAccueil").style.height="250px";document.getElementById("questionnaire_notation_presision").setAttribute("style","display:none");document.getElementById("questionnaire_notation_etoile").setAttribute("style","display:none");document.getElementById("acc_reception").setAttribute("style","display:");document.getElementById("acc_reception").className="accuse";document.getElementById("questionnaire_notation").setAttribute("style","display:none");document.getElementById("btnQuestNotation_Valider").setAttribute("style","display:none");setTimeout(function(){document.getElementById("id_questionnaire_notation").setAttribute("style","opacity:0")},b);setTimeout(function(){viderQuestionnaireNotation()},a);return true}function afficherMerciNotationErreur(){var b=document.getElementById("timeOutQuestionnaireNotation").value;var a=parseFloat(b)+parseFloat(500);document.getElementById("popupNotationAccueil").style.height="250px";document.getElementById("questionnaire_notation").setAttribute("style","display:");document.getElementById("questionnaire_notation_presision").setAttribute("style","display:none");document.getElementById("questionnaire_notation_etoile").setAttribute("style","display:none");document.getElementById("acc_reception_erreur").setAttribute("style","display:");document.getElementById("btnQuestNotation_Valider").setAttribute("style","display:none");document.getElementById("acc_reception_erreur").className="accuse";document.getElementById("questionNotation").value="";document.getElementById("closeQuestionnaireNotation").innerHTML="";countChar("questionNotation","nbCaracNotation","250");if(document.getElementById("id_questionnaire_notation").style.opacity!="0"){setTimeout(function(){document.getElementById("id_questionnaire_notation").setAttribute("style","opacity:0")},b);setTimeout(function(){document.getElementById("id_questionnaire_notation").setAttribute("style","display:none");toutDeselectionner();document.location.href="#"},a)}return true}function initialiserPresisionsInsatisfaction(b,a){document.getElementById("btnQuestNotation_Valider").disabled=false;if(b<=a){document.getElementById("popupNotationAccueil").style.height="395px";document.getElementById("questionnaire_notation_presision").setAttribute("style","display:")}else{document.getElementById("popupNotationAccueil").style.height="250px";document.getElementById("questionnaire_notation_presision").setAttribute("style","display:none")}}function viderQuestionnaireNotation(){var a=document.getElementById("id_questionnaire_notation");if(a!=null){while(a.firstChild){a.removeChild(a.firstChild)}a.parentNode.removeChild(a)}var b=document.getElementById("questionnaire_notation");if(b!=null){while(a.firstChild){a.removeChild(a.firstChild)}}}function initialiserQuestionnaireNotation(c){if(document.getElementById("questionnaire_notation_presision").style.display=="none"&&document.getElementById("questionNotation").value==""){var a=":-:";var b=c.split(";");b.each(function(g,f){var e=g.split(a);var d=e[0];var h=e[1];var i=e[2];ouvrireQuestionnaire();switch(d){case"initialiserNotation":if(h==="voteEffectue"){document.getElementById("acc_reception").className="accuse"}break;case"divQuestNotation_QuestOuv":if(h!=null){document.getElementById(d).innerHTML=h}break;case"divQuestNotation_QuestionPre":if(h!=null){document.getElementById(d).innerHTML=h}break;default:break}})}}function ouvrireQuestionnaire(){document.getElementById("closeQuestionnaireNotation").innerHTML="X";document.getElementById("questionnaire_notation").setAttribute("style","display:");document.getElementById("id_questionnaire_notation").setAttribute("style","display:");document.getElementById("questionnaire_notation_etoile").setAttribute("style","display:");document.getElementById("btnQuestNotation_Valider").setAttribute("style","display:");document.getElementById("acc_reception_erreur").setAttribute("style","display:none")}function CSSsatisfaction(a,c,f){var b=a;var g=document.getElementById(c);var e=f;if(f=="hover"){e="average"}else{if(f=="vote"){e="current";var b=a.substr(a.length-1)}}var d=b*20;g.getElementsByClassName(e)[0].style.background="url(/PortailAS/framework/skins/assure/images/refonte/accueil/etoiles/"+b+"Etoile.png)";g.getElementsByClassName(e)[0].style.width=d+"%"}function CssAideNombreEtoile(){document.getElementById(notation.data.pC+"idVote_r"+1).previousElementSibling.setAttribute("style","line-height:inherit");document.getElementById(notation.data.pC+"idVote_r"+5).previousElementSibling.setAttribute("style","line-height:inherit")}function liOverOut(c){var d=document.getElementById(c);var a=false;var b=notationAssure();if(b!==0){CSSsatisfaction(b,c,"hover");a=true}if(a===false){d.getElementsByClassName("average")[0].style.background="inherit"}}function notationAssure(){var a=0;for(var b=1;b<6;b++){if($(notation.data.pC+"idVote_r"+b).checked){a=b}}return a}function toutDeselectionner(){$(notation.data.pC+"idVote").getElementsByClassName("average")[0].style.background="inherit";for(var a=1;a<6;a++){$(notation.data.pC+"idVote_r"+a).checked=""}};